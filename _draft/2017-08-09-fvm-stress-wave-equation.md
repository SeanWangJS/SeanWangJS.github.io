---
layout: default
---

## 有限体积法解决应力波传播问题

在现实世界中，物体受到冲击作用时，会产生各种各样的行为，具体会怎样显然取决于物理的材料性质以及受到冲击作用性质，当然所处环境也有很大影响。就力学的角度来讲，首先，物体受冲击的区域会产生变形（无论是宏观的还是微观的），这种变形会向波一样向远处扩散，直到介质边界发生反射和透射。说形象点，就类似于向静止的水面投石产生的现象。

但与水面不同的是，这种传播发生在物体内部，而这种变形会对物体本身产生的影响也会因为材料与结构的不同变得十分复杂。为了分析这种复杂行为，需要求解一系列偏微分方程，对于特定的问题，有限体积法是一种相当有效的算法，下面给出算法描述

### 节点受力计算

考虑二维应力传播方程

$$
\begin{align*}
  \begin{array} {cc}
    \frac{\partial \sigma_x}{\partial x} + \frac{\partial \tau_{xy}}{\partial y} =\rho \frac{\partial^2 u}{\partial t^2}\\
	\frac{\partial \tau_{xy}}{\partial x} + \frac{\partial \sigma_y}{\partial y} =\rho \frac{\partial^2 v}{\partial t^2}
  \end{array}
\end{align*}
$$

其中 $$\rho$$ 为密度，$$u, v$$ 分别是质点在 $$x, y$$ 方向上的位移。这一方程规定了线弹性材料中的应力波传播方式，配合相应的边界条件和初始条件，就可以求解出整个计算区域内，各时间点上的应力分布，位移场等等物理量。

下面将计算区域离散化为网格形式

![](/resources/2017-08-09-fvm-stress-wave-equation/mesh-edit.png)

将计算域离散化的原因在于，对于每一个局部，可以进行近似简化处理，并使得总体解符合真实情况。这就好比从侧面看一段往上的楼梯，老远看去就是一条斜直线，但实际上它是由许多短横线、短竖线组成的。同样，如果我们将网格内的每一个单元上的物理参数假设为常量，只在单元之间变化，那么从总体来看，也能模拟出一种平滑的解。

所以在这里我们会假设，在特定时刻，每个网格单元内的应力、应变率、压力等都是常数。另外，为了表达方便，我从网格中单独取出一个节点 P 及其周围的单元，并以节点 P 为中心，选择一片区域 D 作为控制体，然后对每个节点都定义这样的控制体，并假设在特定时刻，每个控制体上的各点，其受力，加速度，速度都等于节点上的相关量。

然后对上述的应力波传播方程在 D 上进行积分（为了方便，这里只考虑第一个方程）

$$
\int_D \frac{\partial \sigma_x}{\partial x} + \frac{\partial \tau_{xy}}{\partial y} \mathrm{d}x\mathrm{d}y = \int_D \rho \frac{\partial^2 u}{\partial t^2} \mathrm{d}x\mathrm{d}y
$$

基于假设：控制体 D 在某一时刻的加速度场为常量，即处处相同，方程右边可以将加速度单独提出积分符号，剩下的就是 D 的质量。而左边可以利用格林公式进行变换，得到如下形式的方程

$$
\int_{\partial D} \sigma_x \mathrm{d}y- \int_{\partial D} \tau_{xy} \mathrm{d}x = m a_x = F_x
$$

其中 $$F_x$$ 为节点在 x 方向上的受力， $$\partial D$$ 为 D 的边界，上式表达了节点力的计算方案。如果将 D 取成围绕 P 的多边形，那么，积分过程可以分段进行，也就是

$$
\int_{\partial D} = \sum\limits_A \int_{A \in \partial D}
$$

其中 A 属于 D 的边集合。这时节点力可以写成

$$
F_x = \sum\limits_{A \in \partial D} \int_A \sigma_x \mathrm{d}y - \sum\limits_{A \in \partial D} \int_A \tau_{xy} \mathrm{d}x
$$

若将控制体 D 的具体形状确定，如下图所示，其中 $$i$$ 位于两对边连线的交点，$$j$$ 位于所在线段中点。

![](/resources/2017-08-09-fvm-stress-wave-equation/route.png)

如此一来，假设线段 $$A$$ 由 $$i$$ 连到 $$j$$，那么

$$
\int_A \sigma_x \mathrm{d}y = \sigma_x^A (y_j - y_i)
$$

由于在单元内的应力为常数，所以应力可以提到积分符号外面，为了区分，这里使用 $$\sigma_x^A$$ 作为线段 $$A$$ 上的应力。这样一来，便很方便的计算得到节点受力。

需要注意的是，前面我们只考虑了模型内部单元对节点的作用，而没有考虑受力边界上的情况。对于边界上的节点，如下图所示

![](/resources/2017-08-09-fvm-stress-wave-equation/bound.jpg)

其受力可以看作两部分，一部分是周围单元的作用，就和前面一样，虽然现在的节点 P 只有一侧收到单元作用，但是我们可以假想另一侧有应力为0的虚拟单元，于是在实体单元一侧控制体照常选取，而虚拟单元由于应力为0，怎么选择都可以。另一部分即为外部受力，在计算过程中直接叠加在内力上即可。



