---
title: 算法拾遗-单源最短路径
tags: 有向图 最短路径 算法
---

**初始化**：

给定带权图 \(G(V, E)\)，以及源节点 \(s\)，为所有节点赋予一个到源节点的最短路径上限 \(u.d = \infty, u \in V, u \ne s\)。

**定义**：

**松弛操作**：假设相邻节点 \(u\) 和 \(v\) 到源节点 \(s\) 的最短路径上限分别为 \(u.d, v.d\)，并且 \(u\) 到 \(v\) 的边权重为 \(w(u, v)\)，如果下式成立

\[
    u.d \ge v.d + w(u, v)
    \]

那么更新 \(u\) 到 \(s\) 的路径上限为 \(u.d = v.d + w(u, v)\)。也就是说松弛操作实际上是根据相邻节点的信息降低目标节点到源节点的最短路径上限。

**引理**（三角不等式）：给定带权图 \(G(V, E)\)，设节点 \(s\) 到节点 \(v\) 的最短路径表示为 \(\delta(s,v)\)，边权重由函数 \(w: E\rightarrow R\)  给出，那么成立下述公式

\[
    \delta(s, v) \le \delta(s, u) + w(u, v)
    \]

其中 \(u, v\) 是相邻节点。

**证明**：这里我们采用反证法，设 \(s\) 到 \(u\) 的最短路径经过的节点序列为 \(p = (s, v_1,, v_2 ... u)\)，假如 \(s\) 到 \(v\) 的最短路径大于 \(s\) 到 \(u\) 的最短路径加上边 \(u, v\) 的权重，也就是节点序列 \((s, v_1,, v_2 ... u, v)\) 的路径长度小于 \(\delta(s, v)\) ，这显然与\(\delta(s, v)\) 是最短路径相矛盾，所以题述三角不等式必然成立。

**引理**（上界性质）：给定带权图 \(G(V, E)\)，以及源节点 \(s\)，经过上述初始化操作后，无论经过什么顺序的松弛操作，对于任意节点 \(u\) 来说，\(u.d\) 始终是离源节点最短路径的上界，即
\[
    u.d \ge \delta(u, s)
    \]

并且，一旦 \(u.d = \delta(u, s)\) ，那么 \(u.d\) 将不再变化。

**证明**：这里我们采用归纳法证明，首先来看基础情况，在初始化之后，对于所有非源节点， \(u.d=\infty\)， \(u.d \ge \delta(u, s)\) 是显然的，而对于源节点，\(s.d = 0 \ge \delta(s, s)\) 同样是显然的。
现在我们假设在松弛 \(p, q\) 之前，对于所有的节点 \(u \in V\) 有 \(u.d \ge \delta(u, s)\)。在松弛的时候，分两种情况

1. 如果 \(p.d \ge q.d + w(p, q)\)，
那么更新 \(p.d = q.d + w(p, q)\)，
又根据归纳假设，我们有 \(q.d \ge \delta(q, s)\)，
所以 \(p.d \ge \delta(q, s) + w(p, q)\)，
再根据三角不等式，有 \(p.d \ge \delta(p, s)\)

2. 如果 \(p.d < q.d + w(p, q)\) ，
那么，\(p.d\) 不变化，
根据归纳假设，有 \(p.d \ge \delta(p, s)\)

于是我们便证明了，不等式 \(u.d \ge \delta(u, s)\) 始终成立，接下来我们证明，一旦 \(u.d = \delta(u, s)\)，则后续的松弛操作都不会改变它的值。
由于 \(v.d + w(u, v) \ge \delta(v, s) + w(u, v) \ge \delta(u, s)\)，
所以，一旦 \(u.d = \delta(u, s)\)，这就意味着 \(u.d \le v.d + w(u, v)\) ，
所以 \(u.d\) 不会再变化。





